<clr-dropdown>
  <button type="button" class="btn btn-link" clrDropdownTrigger [disabled]="!dropzone.enabled">
    {{libText()}}
    <clr-icon shape="caret down"></clr-icon>
  </button>
  <clr-dropdown-menu *clrIfOpen>
    <button type="button" clrDropdownItem *ngFor="let x of libs" (click)="settings.libId = x.id; dropzone.resubmit();">
      {{x.text}}
    </button>
  </clr-dropdown-menu>
</clr-dropdown>

<clr-checkbox [clrInline]="true" [(clrChecked)]="settings.fixFillType" (clrCheckedChange)="dropzone.resubmit()"
              [clrDisabled]="!dropzone.enabled">
  Fix fill type
  <a href="https://github.com/a-student/SvgToVectorDrawableConverter#not-supported-svg-features"
     class="tooltip tooltip-right">
    <clr-icon shape="help"></clr-icon>
    <span class="tooltip-content">
      Rebuild paths in such a way that rendering with any fill-rule leads to the same result.
    </span>
  </a>
</clr-checkbox>

<app-dropzone #dropzone (sending)="sending($event)" (restart)="restart()"></app-dropzone>

<button class="btn btn-sm" (click)="dropzone.reset()" [disabled]="!dropzone.canReset">
  <clr-icon shape="undo"></clr-icon>
  Reset
</button>

<div class="card" [@slideTop]="cardState">
  <div class="card-block">
    <div class="progress-{{progressStateEnum[progressState] | lowercase}}">
      <div *ngIf="!isProgressRunning; else runningProgress" class="progress-static top">
        <div class="progress-meter" data-value="100"></div>
      </div>
      <ng-template #runningProgress>
        <div class="progress loop top"><progress value="0"></progress></div>
      </ng-template>
    </div>
    <div class="card-title">{{cardTitle}}</div>
    <div class="card-text pre-wrap" [innerHTML]="cardText | cardTextBeautify" #cardTextContainer></div>
  </div>
  <div class="card-footer" [hidden]="!canAbortConversion && !canRetryConversion && !zipBlob">
    <button class="btn btn-sm btn-link"
            (click)="abortConversionModalOpen = true" [hidden]="!canAbortConversion">
      <clr-icon shape="times"></clr-icon>
      Abort
    </button>
    <button class="btn btn-primary"
            (click)="dropzone.resubmit()" [hidden]="!canRetryConversion">
      <clr-icon shape="refresh"></clr-icon>
      {{retryButtonText}}
    </button>
    <button class="btn btn-primary" [class.btn-success]="progressState === progressStateEnum.Success"
            (click)="saveZip()" [hidden]="!zipBlob">
      <clr-icon shape="download"></clr-icon>
      {{fileCount > 1 ? 'Save ZIP with ' + fileCount + ' vector drawables' : fileCount === 1 ? 'Save ZIP with 1 vector drawable' : 'Save ZIP'}}
    </button>
  </div>
</div>

<clr-modal [(clrModalOpen)]="abortConversionModalOpen">
  <h3 class="modal-title">Abort conversion</h3>
  <div class="modal-body">
    <p>Are you sure you want to abort the conversion?</p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline" (click)="abortConversionModalOpen = false">No, close this</button>
    <button type="button" class="btn btn-danger" (click)="dropzone.cancel()">Yes, abort conversion</button>
  </div>
</clr-modal>

<app-xml-view [title]="singleFileTitle" [xml]="singleFileXml" [@slideTop]="xmlViewState">
</app-xml-view>
